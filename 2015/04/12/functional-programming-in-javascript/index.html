<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="木易日志，木易某某，Each step should be recorded for the future."><meta name="keywords" content="木易日志, 木易某某, owenyang, owenyang0, code, personal opinion, OwenYang ideas"><title>Functional Programming in JavaScript | 修远</title><link rel="stylesheet" type="text/css" href="/css/index.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script src="https://www.googletagmanager.com/gtag/js?id=UA-57882600-1" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-57882600-1');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement('script');
  hm.src = 'https://hm.baidu.com/hm.js?' + 'bb6f3c4c30430bc657467462f66fc66c';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Functional Programming in JavaScript</h1><a id="logo" href="/.">修远</a><p class="description">其修远兮之路漫漫，吾将求索于墙外之巅</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Functional Programming in JavaScript</h1><div class="post-meta">Apr 12 2015</div><a class="disqus-comment-count" data-disqus-identifier="2015/04/12/functional-programming-in-javascript/" href="/2015/04/12/functional-programming-in-javascript/#disqus_thread"></a><div class="post-content"><h2 id="Agenda"><a href="#Agenda" class="headerlink" title="Agenda"></a>Agenda</h2><ul>
<li>What is Functional Programming?</li>
<li>How Functional Programming Differs From Other Paradigms</li>
<li>Functional Programming in Javascript</li>
<li>Advantages and Disadvantages of Functional Style</li>
<li>Interaction of Functional and Object-Oriented Styles</li>
</ul>
<hr>
<h2 id="What-is-Functional-Programming"><a href="#What-is-Functional-Programming" class="headerlink" title="What is Functional Programming?"></a>What is Functional Programming?</h2><ul>
<li><strong>Restricted sense,</strong> FP means programming without mutable variables, assignments, loops and other imperative control structures</li>
<li><strong>Wider sense,</strong> FP means focusing on the functions</li>
<li><strong>Particularly,</strong> functions can be values that are produced, consumed, and composed.</li>
</ul>
<hr>
<h2 id="Functional-Programming-Languages"><a href="#Functional-Programming-Languages" class="headerlink" title="Functional Programming Languages"></a>Functional Programming Languages</h2><p>Functions in a FP languages are first-class citizens. This means:</p>
<ul>
<li>they can be defined anywhere, including inside other function</li>
<li>like any other values, they can be passed as parameters to functions and returned as results</li>
<li>as for other values, there exist a set of operators to compose functions</li>
</ul>
<hr>
<h2 id="Some-languages"><a href="#Some-languages" class="headerlink" title="Some languages"></a>Some languages</h2><p><strong>Restricted sense:</strong></p>
<ul>
<li>Pure Lisp, XSLT, XPath, XQuery, FP</li>
</ul>
<p><strong>Wider sense:</strong></p>
<ul>
<li>JavaScript</li>
<li>Lisp, Scheme, Racket, Clojure</li>
<li>SML, F#</li>
<li>Haskell (full language)</li>
<li>Scala</li>
</ul>
<hr>
<h2 id="OOP-vs-FP"><a href="#OOP-vs-FP" class="headerlink" title="OOP vs FP"></a>OOP vs FP</h2><p>OO focuses on the differences in the data, while FP concentrates on consistent data structures.</p>
<hr>
<h3 id="Object-Oriented"><a href="#Object-Oriented" class="headerlink" title="Object-Oriented"></a>Object-Oriented</h3><ul>
<li>Data and the operations upon it are tightly coupled</li>
<li>Objects hide their implementation of operations from other objects via their interfaces</li>
<li>The central model for abstraction is the data itself</li>
<li>The central activity is composing new objects and extending existing objects by adding new methods to them</li>
</ul>
<hr>
<h3 id="Functional"><a href="#Functional" class="headerlink" title="Functional"></a>Functional</h3><ul>
<li>Data is only loosely coupled to functions</li>
<li>Functions hide their implementation, and the language’s abstractions speak to functions and the way they are combined or expressed</li>
<li>The central model for abstraction is the function, not the data structure.<br>The central activity is writing new functions</li>
</ul>
<hr>
<h2 id="Declarative-vs-Imperative"><a href="#Declarative-vs-Imperative" class="headerlink" title="Declarative vs Imperative"></a>Declarative vs Imperative</h2><p>One main distinguishing characteristics of functional programming languages is that they describe what they want done, and not how to do it. OO, inside its methods, still uses mostly imperative techniques.</p>
<hr>
<h3 id="Imperative-programming-is-about"><a href="#Imperative-programming-is-about" class="headerlink" title="Imperative programming is about"></a>Imperative programming is about</h3><ul>
<li>modifying mutable variables</li>
<li>using assignment</li>
<li>and control structures such as if-then-else, loops, break, continue, return.</li>
</ul>
<hr>
<p>The most common informal way to understand imperative programs is as instruction sequences for a Von Neumann computer</p>
<p>Processor <---- bus ----> Memory</p>
<hr>
<h3 id="Declarative-programming-is-about"><a href="#Declarative-programming-is-about" class="headerlink" title="Declarative programming is about"></a>Declarative programming is about</h3><ul>
<li>concentrate on functions</li>
<li>avoid mutations (mutation can bestroy useful laws)</li>
<li>have powerful ways to abstract and compose functions</li>
</ul>
<hr>
<h3 id="Imperative-style"><a href="#Imperative-style" class="headerlink" title="Imperative style"></a>Imperative style</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var sumOfSquares = function(list) &#123;</span><br><span class="line">    var result = 0;</span><br><span class="line">    for (var i = 0; i &lt; list.length; i++) &#123;</span><br><span class="line">        result += square(list[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">console.log(sumOfSquares([2, 3, 5]));</span><br></pre></td></tr></table></figure>
<h3 id="Functional-style"><a href="#Functional-style" class="headerlink" title="Functional style"></a>Functional style</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sumOfSquares = <span class="title function_">pipe</span>(<span class="title function_">map</span>(square), <span class="title function_">reduce</span>(add, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">sumOfSquares</span>([<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>]));</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Functional-Features-in-JavaScript"><a href="#Functional-Features-in-JavaScript" class="headerlink" title="Functional Features in JavaScript"></a>Functional Features in JavaScript</h2><h3 id="Easily-available-in-Javascript"><a href="#Easily-available-in-Javascript" class="headerlink" title="Easily available in Javascript"></a>Easily available in Javascript</h3><ul>
<li>First-class functions</li>
<li>Lambdas/Anonymous Functions with closures</li>
<li>Compact, even terse, functions</li>
</ul>
<h3 id="Possible-to-accomplish-in-JavaScript"><a href="#Possible-to-accomplish-in-JavaScript" class="headerlink" title="Possible to accomplish in JavaScript"></a>Possible to accomplish in JavaScript</h3><ul>
<li>Mostly stateless processing</li>
<li>Side-effect-free functions calls</li>
</ul>
<hr>
<h3 id="Not-available-in-JavaScript"><a href="#Not-available-in-JavaScript" class="headerlink" title="Not available in JavaScript"></a>Not available in JavaScript</h3><ul>
<li>Performant recursion through tail call optimization</li>
<li>Pattern matching (Haskell, Erlang)</li>
<li>Lazy Evaluation (Miranda, Haskell)</li>
<li>Homoiconicity (mostly LISP-like languages?)</li>
</ul>
<hr>
<h3 id="Shared-examples"><a href="#Shared-examples" class="headerlink" title="Shared examples"></a>Shared examples</h3><p>This calculates the odds of choosing the correct <code>n</code> numbers out of the <code>p</code> possibilities.</p>
<h3 id="iterative-version"><a href="#iterative-version" class="headerlink" title="iterative version"></a>iterative version</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">odds</span>(<span class="params">n, p</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> acc = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        acc *= (n - i) / (p - i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> acc;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">odds</span>(<span class="number">3</span>, <span class="number">10</span>)); <span class="comment">//=&gt; (3/10) * (2/9) * (1/8) =&gt; (1/120) =&gt; 0.008333...</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Recursive-version"><a href="#Recursive-version" class="headerlink" title="Recursive version"></a>Recursive version</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Recursive version</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">odds</span>(<span class="params">n, p</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (n == <span class="number">0</span>) ? <span class="number">1</span> : (n / p) * <span class="title function_">odds</span>(n - <span class="number">1</span>, p - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">odds</span>(<span class="number">3</span>, <span class="number">10</span>)); <span class="comment">//=&gt; (3/10) * (2/9) * (1/8) =&gt; (1/120) =&gt; 0.008333...</span></span><br></pre></td></tr></table></figure>
<ul>
<li>recursive functions are often much more elegant than their iterative cousins.</li>
<li>Unfortunately, they often don’t perform as well. All the overhead of creating stack contexts for function calls tends to add up. But certain kinds of recursive calls can be easily optimized.</li>
</ul>
<hr>
<h3 id="tail-recursive"><a href="#tail-recursive" class="headerlink" title="tail recursive"></a>tail recursive</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var odds = (function()&#123;</span><br><span class="line">    var odds1 = function(n, p, acc) &#123;</span><br><span class="line">        return (n == 0) ? acc : odds1(n - 1, p - 1, (n / p) * acc);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return function(n, p) &#123;</span><br><span class="line">        return odds1(n, p, 1)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>Note that the recursive call in <strong>odds1</strong> is the last statement in its branch of the function. If this is true for all recursive calls, then the function is <strong>tail-recursive</strong>, and the compiler can replace the entire set of nested calls with simple <strong>JUMP</strong> operations.</p>
<hr>
<h2 id="Functional-Programming-in-Javascript"><a href="#Functional-Programming-in-Javascript" class="headerlink" title="Functional Programming in Javascript"></a>Functional Programming in Javascript</h2><p>With first-class function, closures, and anonymous functions, Javascript allows us to do a great deal of functional programming, even if we don’t have things like pattern matching and homoiconicity.</p>
<p>There are some tools built in to modern Javascript environments, and it’s straightforward to roll your own.</p>
<ul>
<li>Ramda</li>
<li>Underscore, Lo-Dash</li>
</ul>
<hr>
<h2 id="Using-Functional-Techniques-in-JavaScript"><a href="#Using-Functional-Techniques-in-JavaScript" class="headerlink" title="Using Functional Techniques in JavaScript"></a>Using Functional Techniques in JavaScript</h2><p>Example will be a Task List application, fetching something like the following data from the server:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> data = &#123;</span><br><span class="line">    <span class="attr">result</span>: <span class="string">&quot;SUCCESS&quot;</span>,</span><br><span class="line">    <span class="attr">interfaceVersion</span>: <span class="string">&quot;1.0.3&quot;</span>,</span><br><span class="line">    <span class="attr">requested</span>: <span class="string">&quot;10/17/2013 15:31:20&quot;</span>.</span><br><span class="line">    <span class="attr">lastUpdated</span>: <span class="string">&quot;10/16/2013 10:52:39&quot;</span>,</span><br><span class="line">    <span class="attr">tasks</span>: [</span><br><span class="line">        &#123;<span class="attr">id</span>: <span class="number">104</span>, <span class="attr">complete</span>: <span class="literal">false</span>,            <span class="attr">priority</span>: <span class="string">&quot;high&quot;</span>,</span><br><span class="line">                  <span class="attr">dueDate</span>: <span class="string">&quot;11/29/2013&quot;</span>,      <span class="attr">member</span>: <span class="string">&quot;Scott&quot;</span>,</span><br><span class="line">                  <span class="attr">title</span>: <span class="string">&quot;Do something&quot;</span>,      <span class="attr">created</span>: <span class="string">&quot;9/22/2013&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">id</span>: <span class="number">105</span>, <span class="attr">complete</span>: <span class="literal">false</span>,            <span class="attr">priority</span>: <span class="string">&quot;medium&quot;</span>,</span><br><span class="line">                  <span class="attr">dueDate</span>: <span class="string">&quot;11/22/2013&quot;</span>,      <span class="attr">member</span>: <span class="string">&quot;Lena&quot;</span>,</span><br><span class="line">                  <span class="attr">title</span>: <span class="string">&quot;Do something else&quot;</span>, <span class="attr">created</span>: <span class="string">&quot;9/22/2013&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">id</span>: <span class="number">107</span>, <span class="attr">complete</span>: <span class="literal">true</span>,             <span class="attr">priority</span>: <span class="string">&quot;high&quot;</span>,</span><br><span class="line">                  <span class="attr">dueDate</span>: <span class="string">&quot;11/22/2013&quot;</span>,      <span class="attr">member</span>: <span class="string">&quot;Mike&quot;</span>,</span><br><span class="line">                  <span class="attr">title</span>: <span class="string">&quot;Fix the foo&quot;</span>,       <span class="attr">created</span>: <span class="string">&quot;9/22/2013&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">id</span>: <span class="number">108</span>, <span class="attr">complete</span>: <span class="literal">false</span>,            <span class="attr">priority</span>: <span class="string">&quot;low&quot;</span>,</span><br><span class="line">                  <span class="attr">dueDate</span>: <span class="string">&quot;11/15/2013&quot;</span>,      <span class="attr">member</span>: <span class="string">&quot;Punam&quot;</span>,</span><br><span class="line">                  <span class="attr">title</span>: <span class="string">&quot;Adjust the bar&quot;</span>,    <span class="attr">created</span>: <span class="string">&quot;9/25/2013&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">id</span>: <span class="number">110</span>, <span class="attr">complete</span>: <span class="literal">false</span>,            <span class="attr">priority</span>: <span class="string">&quot;medium&quot;</span>,</span><br><span class="line">                  <span class="attr">dueDate</span>: <span class="string">&quot;11/15/2013&quot;</span>,      <span class="attr">member</span>: <span class="string">&quot;Scott&quot;</span>,</span><br><span class="line">                  <span class="attr">title</span>: <span class="string">&quot;Rename everything&quot;</span>, <span class="attr">created</span>: <span class="string">&quot;10/2/2013&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">id</span>: <span class="number">112</span>, <span class="attr">complete</span>: <span class="literal">true</span>,             <span class="attr">priority</span>: <span class="string">&quot;high&quot;</span>,</span><br><span class="line">                  <span class="attr">dueDate</span>: <span class="string">&quot;11/27/2013&quot;</span>,      <span class="attr">member</span>: <span class="string">&quot;Lena&quot;</span>,</span><br><span class="line">                  <span class="attr">title</span>: <span class="string">&quot;Alter all quuxes&quot;</span>,  <span class="attr">created</span>: <span class="string">&quot;10/5/2013&quot;</span>&#125;</span><br><span class="line">        <span class="comment">// , ...</span></span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Goal"><a href="#Goal" class="headerlink" title="Goal"></a>Goal</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tasks: [</span><br><span class="line">        &#123;id: 104, complete: false,            priority: &quot;high&quot;,</span><br><span class="line">                  dueDate: &quot;11/29/2013&quot;,      member: &quot;Scott&quot;,</span><br><span class="line">                  title: &quot;Do something&quot;,      created: &quot;9/22/2013&quot;&#125;,</span><br><span class="line">        &#123;id: 105, complete: false,            priority: &quot;medium&quot;,</span><br><span class="line">                  dueDate: &quot;11/22/2013&quot;,      member: &quot;Lena&quot;,</span><br><span class="line">                  title: &quot;Do something else&quot;, created: &quot;9/22/2013&quot;&#125;,</span><br><span class="line">    // , ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>The goal will be a function that accepts a <code>member</code> parameter, then fetches the data from the server (or from some application cache), chooses the tasks for that member that are not complete, returns their ids, priorities, titles, and dues dates, sorted by due date.</p>
<ul>
<li>asynchronous, we’ll hook everything together with promises.</li>
<li>ignore all error-checking</li>
</ul>
<hr>
<h2 id="Imperative-Approach"><a href="#Imperative-Approach" class="headerlink" title="Imperative Approach"></a>Imperative Approach</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> getIncompleteTaskSummariesForMember_imperative = <span class="keyword">function</span>(<span class="params">memberName</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fetchData</span>()</span><br><span class="line">        .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> data.<span class="property">tasks</span>;</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">tasks</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> results = [];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tasks[i].<span class="property">member</span> == memberName) &#123;</span><br><span class="line">                    results.<span class="title function_">push</span>(tasks[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> results;</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">tasks</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> results = [];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!tasks[i].<span class="property">complete</span>) &#123;</span><br><span class="line">                    results.<span class="title function_">push</span>(tasks[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> results;</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">tasks</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> results = [], task;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">                task = tasks[i];</span><br><span class="line">                results.<span class="title function_">push</span>(&#123;</span><br><span class="line">                    <span class="attr">id</span>: task.<span class="property">id</span>,</span><br><span class="line">                    <span class="attr">dueDate</span>: task.<span class="property">dueDate</span>,</span><br><span class="line">                    <span class="attr">title</span>: task.<span class="property">title</span>,</span><br><span class="line">                    <span class="attr">priority</span>: task.<span class="property">priority</span></span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> results;</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">tasks</span>) &#123;</span><br><span class="line">            tasks.<span class="title function_">sort</span>(<span class="keyword">function</span>(<span class="params">first, second</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> first.<span class="property">dueDate</span> - second.<span class="property">dueDate</span>;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">return</span> tasks;</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Object-Oriented-Approach"><a href="#Object-Oriented-Approach" class="headerlink" title="Object-Oriented Approach"></a>Object-Oriented Approach</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main method</span></span><br><span class="line"><span class="keyword">var</span> getIncompleteTaskSummariesForMember_objectOriented = <span class="keyword">function</span>(<span class="params">memberName</span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="title function_">fetchData</span>()</span><br><span class="line">       .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">           <span class="keyword">var</span> taskList = <span class="keyword">new</span> <span class="title class_">TaskList</span>(data.<span class="property">tasks</span>);</span><br><span class="line">           taskList.<span class="title function_">chooseByMember</span>(memberName);</span><br><span class="line">           taskList.<span class="title function_">chooseByCompletion</span>(<span class="literal">false</span>);</span><br><span class="line">           <span class="keyword">var</span> newTaskList = taskList.<span class="title function_">getSummaries</span>();</span><br><span class="line">           newTaskList.<span class="title function_">sort</span>(<span class="keyword">new</span> <span class="title class_">TaskListSorter</span>(<span class="string">&quot;dueDate&quot;</span>));</span><br><span class="line">           <span class="keyword">return</span> newTaskList.<span class="property">tasks</span>;</span><br><span class="line">       &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">var TaskList = (function() &#123;</span><br><span class="line">    var TaskList = function(/*Task[]*/ tasks) &#123;</span><br><span class="line">        this.tasks = tasks;</span><br><span class="line">    &#125;;</span><br><span class="line">    TaskList.prototype.chooseByMember = function(memberName) &#123;</span><br><span class="line">        var results = [];</span><br><span class="line">        for (var i = 0, len = this.tasks.length; i &lt; len; i++) &#123;</span><br><span class="line">            if (this.tasks[i].member === memberName) &#123;</span><br><span class="line">                results.push(this.tasks[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        this.tasks = results;</span><br><span class="line">    &#125;;</span><br><span class="line">    TaskList.prototype.chooseByCompletion = function(completion) &#123;</span><br><span class="line">        var results = [];</span><br><span class="line">        for (var i = 0, len = this.tasks.length; i &lt; len; i++) &#123;</span><br><span class="line">            if (this.tasks[i].complete == completion) &#123;</span><br><span class="line">                results.push(this.tasks[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        this.tasks = results;</span><br><span class="line">    &#125;;</span><br><span class="line">    TaskList.prototype.getSummaries = function() &#123;</span><br><span class="line">            var results = [], task;</span><br><span class="line">            for (var i = 0, len = this.tasks.length; i &lt; len; i++) &#123;</span><br><span class="line">                task = this.tasks[i];</span><br><span class="line">                results.push(&#123;</span><br><span class="line">                    id: task.id,</span><br><span class="line">                    dueDate: task.dueDate,</span><br><span class="line">                    title: task.title,</span><br><span class="line">                    priority: task.priority</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">            return new TaskList(results);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        TaskList.prototype.sort = function(/*TaskListSorter*/ sorter) &#123;</span><br><span class="line">            this.tasks.sort(sorter.getSortFunction());</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        return TaskList;</span><br><span class="line">    &#125;());</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">var TaskListSorter = (function()  &#123;</span><br><span class="line">    var TaskListSorter = function(propName) &#123;</span><br><span class="line">        this.propName = propName;</span><br><span class="line">    &#125;;</span><br><span class="line">    TaskListSorter.prototype.getSortFunction = function() &#123;</span><br><span class="line">        var propName = this.propName;</span><br><span class="line">        return function(first, second) &#123;</span><br><span class="line">            return first[propName] &lt; second[propName] ? -1 :</span><br><span class="line">                   first[propName] &gt; second[propName] ? +1 : 0;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    return TaskListSorter;</span><br><span class="line">&#125;());</span><br></pre></td></tr></table></figure>
<p>The contents of the functions are much the same; it’s the way they are organized that varies.</p>
<hr>
<h2 id="Converting-to-Functional-Code"><a href="#Converting-to-Functional-Code" class="headerlink" title="Converting to Functional Code"></a>Converting to Functional Code</h2><p>The process for the remainder of this talk will be to convert this code into concise, readable, functional code, one block at a time, explaining some of the basic building blocks of functional programming as we go. First up is this little function:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> data.<span class="property">tasks</span>;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>Functional version<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_">then</span>(<span class="title function_">prop</span>(<span class="string">&#x27;tasks&#x27;</span>))</span><br></pre></td></tr></table></figure></p>
<p>So the obvious question, then, is, what is the <strong>prop</strong> function?</p>
<hr>
<h2 id="The-prop-function"><a href="#The-prop-function" class="headerlink" title="The prop function"></a>The prop function</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title function_">_curry2</span>(<span class="keyword">function</span> <span class="title function_">prop</span>(<span class="params">p, obj</span>) &#123; <span class="keyword">return</span> obj[p]; &#125;);</span><br></pre></td></tr></table></figure>
<p>Our <strong>then</strong> call needs a function, so <strong>curry</strong> must be doing something interesting with this function, which should return an object propery, to instead returning a new function. So we need to take a detour to discuss <strong>curry</strong> a bit.</p>
<hr>
<h2 id="Currying-Functions"><a href="#Currying-Functions" class="headerlink" title="Currying Functions"></a>Currying Functions</h2><p>Currying is the process of converting functions that take multiple arguments into ones that, when supplied fewer arguments, return new functions that accept the remaining ones.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> addFourNumbers = <span class="keyword">function</span>(<span class="params">a, b, c, d</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b + c + d;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> curriedAddFourNumbers = R.<span class="title function_">curry</span>(addFourNumbers);</span><br><span class="line"><span class="keyword">var</span> f = <span class="title function_">curriedAddFourNumbers</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">var</span> g = <span class="title function_">f</span>(<span class="number">3</span>);</span><br><span class="line"><span class="title function_">g</span>(<span class="number">4</span>); <span class="comment">//=&gt; 10</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Back-to-get"><a href="#Back-to-get" class="headerlink" title="Back to get"></a>Back to get</h2><p>Now that we understand curry, we can see that a manually curried version of this function might look like this:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> prop = <span class="keyword">function</span>(<span class="params">prop</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> obj[prop];</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>And that means that our new <strong>get(‘tasks’)</strong> is equivalent to<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> obj[<span class="string">&#x27;tasks&#x27;</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="Filtering"><a href="#Filtering" class="headerlink" title="Filtering"></a>Filtering</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">tasks</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> results = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (tasks[i].<span class="property">member</span> == memberName) &#123;</span><br><span class="line">            results.<span class="title function_">push</span>(tasks[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> results;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<p>Functional version<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_">then</span>(<span class="title function_">filter</span>(<span class="keyword">function</span>(<span class="params">task</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> task.<span class="property">member</span> == memberName;</span><br><span class="line">&#125;))</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>But we’ve done something more important too: We’ve moved the focus from iteration and updating the state of a local collection to the real point of this block: choosing the tasks with the proper member property.</p>
<p>One of the most important features of functional programming is that it makes it easy to shift focus in this manner.</p>
<hr>
<h2 id="Rejecting-elements"><a href="#Rejecting-elements" class="headerlink" title="Rejecting elements"></a>Rejecting elements</h2><p>The next block is similar, except that instead of using filter, we will use reject, which behaves exactly the same except that it chooses those members of the list that don’t match the predicate. We replace this code:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">tasks</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> results = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!tasks[i].<span class="property">complete</span>) &#123;</span><br><span class="line">            results.<span class="title function_">push</span>(tasks[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> results;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>with this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_">then</span>(<span class="title function_">reject</span>(<span class="keyword">function</span>(<span class="params">task</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> task.<span class="property">complete</span> === <span class="literal">true</span>;</span><br><span class="line">)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Refactoring"><a href="#Refactoring" class="headerlink" title="Refactoring"></a>Refactoring</h2><p>A reasonable question would be why with didn’t do this instead, which would work equally well:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.then(filter(function(task) &#123;</span><br><span class="line">    return task.complete !== true;</span><br><span class="line">))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>The reason is that the similarity between these two blocks will offer us a chance to refactor our code into something still more descriptive:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function(task) &#123;</span><br><span class="line">    return task.member == memberName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function(task) &#123;</span><br><span class="line">    return task.complete === true;</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Both of these functions accept an object and return a boolean that describes whether a particular property of the object has a given value. Perhaps a good name for a function that generates such functions would be <strong>propEq</strong>.</p>
<hr>
<h2 id="Implementing-propEq"><a href="#Implementing-propEq" class="headerlink" title="Implementing propEq"></a>Implementing propEq</h2><p>Simplest Approach<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> propEq = <span class="keyword">function</span>(<span class="params">prop, val</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> obj[prop] === val;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>This works, and we could leave it there, but we’re going to take another detour into a popular style of functional programming known as <strong>points-free</strong> coding.</p>
<hr>
<h2 id="Points-free-definitions"><a href="#Points-free-definitions" class="headerlink" title="Points-free definitions"></a>Points-free definitions</h2><p>With the functions <strong>add</strong> (which adds two numbers) and <strong>reduce</strong> (which runs the supplied function against an accumulator and each element of the list, feeding the result of each call into the next one and returning the final result), we can easily define a <strong>sum</strong> function like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sum = <span class="keyword">function</span>(<span class="params">list</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">reduce</span>(add, <span class="number">0</span>, list);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Because of the automatic currying, though, the following is entirely equivalent:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sum = <span class="title function_">reduce</span>(add, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p>This is the <strong>points-free</strong> style, defining functions without ever making direct reference to their arguments.</p>
<hr>
<p><strong>Wikipedia</strong></p>
<blockquote>
</blockquote>
<p>Tacit [point-free] programming is a programming paradigm in which a function definition does not include information regarding its arguments, using combinators and function composition (but not ?-abstraction) instead of variables.</p>
<p>There are plenty of reasons to like it, but the most important one might just be the simplicity. There is a great deal to be said for elegant, readable code.</p>
<hr>
<h2 id="A-points-free-version-of-propEq"><a href="#A-points-free-version-of-propEq" class="headerlink" title="A points-free version of propEq"></a>A points-free version of propEq</h2><p>Can we redefine the following in a points-free style?</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> propEq = <span class="keyword">function</span>(<span class="params">prop, val</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> obj[prop] === val;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Here’s a version that is closer to points-free, removing the direct reference to obj:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> propEq = <span class="keyword">function</span>(<span class="params">prop, val</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">compose</span>(<span class="title function_">eq</span>(val), <span class="title function_">get</span>(prop));</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>Huh? What? <strong>compose</strong>? <strong>eq</strong>?</p>
<p><strong>eq</strong> is easy: like all good functions of multiple parameters, it’s curried, and it simply reports whether its two arguments are equal. So <strong>eq(val)</strong> is a function which reports whether its parameter has the same value as does <strong>val</strong>. But now we need to discuss <strong>compose</strong>.</p>
<hr>
<h2 id="Functional-composition"><a href="#Functional-composition" class="headerlink" title="Functional composition"></a>Functional composition</h2><p>In mathematics <strong>f ∘ g</strong> (pronounced “f composed with g”) is the function that given <strong>x</strong>, returns <strong>f(g(x))</strong>.</p>
<p>So if we follow the mathematical model <strong>compose(add1, square)(x)</strong> should equal <strong>add1(square(x))</strong>.</p>
<p>Simplest Implementation</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> compose = <span class="keyword">function</span>(<span class="params">f, g</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">x</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">f</span>(<span class="title function_">g</span>(x));</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Note that <strong>Ramda</strong> also defines <strong>pipe</strong>, which does much the same thing, but runs the functions in the opposite order. So <strong>pipe(add1, square)(x)</strong> equals <strong>square(add1(x))</strong>. Both styles have their uses.</p>
<hr>
<h2 id="Back-to-propEq"><a href="#Back-to-propEq" class="headerlink" title="Back to propEq"></a>Back to propEq</h2><p>So now this definition makes sense:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> propEq = <span class="keyword">function</span>(<span class="params">prop, val</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">pipe</span>(<span class="title function_">get</span>(prop), <span class="title function_">eq</span>(val));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Note the switch from <strong>compose</strong> to <strong>pipe</strong>.</p>
<p>This gives us a further way to clean it up, and make it entirely <strong>points-free</strong>, using a useful feature of Ramda we haven’t seen implemented in other libraries, which we call (for now) <strong>callWith</strong>. Used like <strong>callWith(fn, transformer1, … transformerN)</strong>, this returns a function which accepts N parameters, feeds them to the respective transformers, and then calls <strong>fn</strong> using the results of all these. This gives us the final version of propEq:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> propEq = <span class="title function_">callWith</span>(pipe, get, eq);</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Definition-of-propEq"><a href="#Definition-of-propEq" class="headerlink" title="Definition of propEq"></a>Definition of propEq</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">module.exports = _curry3(function propEq(name, val, obj) &#123;</span><br><span class="line">  return _eq(obj[name], val);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Using-our-new-function"><a href="#Using-our-new-function" class="headerlink" title="Using our new function"></a>Using our new function</h2><p>Still, all these explanations aside, it was only a minute or two of work to do this refactoring and arrive at a fairly simple version of <strong>propEq</strong>. We would plug it back in like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> propEq = <span class="title function_">callWith</span>(pipe, get, eq);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">.<span class="title function_">then</span>(<span class="title function_">filter</span>(<span class="title function_">propEq</span>(<span class="string">&#x27;member&#x27;</span>, memberName)))</span><br><span class="line">.<span class="title function_">then</span>(<span class="title function_">reject</span>(<span class="title function_">propEq</span>(<span class="string">&#x27;complete&#x27;</span>, <span class="literal">true</span>)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="New-objects-from-old"><a href="#New-objects-from-old" class="headerlink" title="New objects from old"></a>New objects from old</h2><p>The next block we wanted to update looked like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">tasks</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> results = [], task;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">        task = tasks[i];</span><br><span class="line">        results.<span class="title function_">push</span>(&#123;</span><br><span class="line">            <span class="attr">id</span>: task.<span class="property">id</span>,</span><br><span class="line">            <span class="attr">dueDate</span>: task.<span class="property">dueDate</span>,</span><br><span class="line">            <span class="attr">title</span>: task.<span class="property">title</span>,</span><br><span class="line">            <span class="attr">priority</span>: task.<span class="property">priority</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> results;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Functional version:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_">then</span>(<span class="title function_">map</span>(<span class="title function_">pick</span>([<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;dueDate&#x27;</span>, <span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;priority&#x27;</span>])))</span><br></pre></td></tr></table></figure>
<p>You’re a smart bunch, right? I probably don’t even have to explain what pick does, right?</p>
<hr>
<h2 id="The-map-function"><a href="#The-map-function" class="headerlink" title="The map function"></a>The <strong>map</strong> function</h2><p>One of the most fundamental functions used in FP is <strong>map</strong>, which is used to convert one list into a related one by running the same function against each member.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fiveSquares = <span class="title function_">map</span>(square, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]); <span class="comment">// =&gt; [1, 4, 9, 16, 25];</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> shouts = <span class="title function_">map</span>(toUpperCase, [<span class="string">&quot;oy&quot;</span>, <span class="string">&quot;vey&quot;</span>]); <span class="comment">//=&gt; [&quot;OY&quot;, &quot;VEY&quot;]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>There isn’t much more to say about <strong>map</strong>, but it’s important to point out that this function and <strong>reduce</strong>, which we mentioned briefly earlier, are among the most important functional programming tools around.</p>
<hr>
<h2 id="Partial-clones-of-our-objects"><a href="#Partial-clones-of-our-objects" class="headerlink" title="Partial clones of our objects"></a>Partial clones of our objects</h2><p>We used map like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_">then</span>(<span class="title function_">map</span>(<span class="title function_">pick</span>([<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;dueDate&#x27;</span>, <span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;priority&#x27;</span>])))</span><br></pre></td></tr></table></figure>
<p>The magic of currying is again at work here:</p>
<ul>
<li><strong>pick</strong> accepts a list of properties and an object and return a partial clone, copying those properties from the original. Since we just pass in the properties, this curried function returns a new function that accepts an object and returns that partial clone.</li>
<li><strong>map</strong> accepts a function and a list an applies the function to the list. But because it’s curried, and because we supply only the function generated by the curried pick, this one also returns a new function which will accept a list and create these partial clones of each element in the list.</li>
<li>This function is passed to <strong>then</strong>, which will simply pass along its parameter (whenever that becomes ready) to our function and “return” the result of running our function against it. (We simply know because of the way prior calls have been built that this will be a list of tasks.)</li>
</ul>
<hr>
<h2 id="A-final-task-of-some-sort"><a href="#A-final-task-of-some-sort" class="headerlink" title="A final task of some sort"></a>A final task of some sort</h2><p>The last segment we wanted to convert looked like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.then(function(tasks) &#123;</span><br><span class="line">    tasks.sort(function(first, second) &#123;</span><br><span class="line">        return first.dueDate - second.dueDate;</span><br><span class="line">    &#125;);</span><br><span class="line">    return tasks;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Sorts the list according to a key generated by the supplied function.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sortByFirstItem = R.<span class="title function_">sortBy</span>(<span class="title function_">prop</span>(<span class="number">0</span>));</span><br><span class="line"><span class="keyword">var</span> pairs = [[-<span class="number">1</span>, <span class="number">1</span>], [-<span class="number">2</span>, <span class="number">2</span>], [-<span class="number">3</span>, <span class="number">3</span>]];</span><br><span class="line"><span class="title function_">sortByFirstItem</span>(pairs); <span class="comment">//=&gt; [[-3, 3], [-2, 2], [-1, 1]]</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Again-with-the-curry"><a href="#Again-with-the-curry" class="headerlink" title="Again with the curry"></a>Again with the curry</h2><p>Again, we take advantage of the fact that our important functions are curried, and use <strong>prop(‘dueDate’)</strong>. This creates a function that, fed one of our task objects, returns its due date. We can feed this into <strong>sortBy</strong> to get the following:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.then(sortBy(prop(&#x27;dueDate&#x27;)))</span><br></pre></td></tr></table></figure>
<hr>
<p>While this is not a lot less code than the original:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">tasks</span>) &#123;</span><br><span class="line">    tasks.<span class="title function_">sort</span>(<span class="keyword">function</span>(<span class="params">first, second</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> first.<span class="property">dueDate</span> - second.<span class="property">dueDate</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> tasks;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>it clearly is a savings. However, much more importantly, the code is all clearly aimed at our problem.</p>
<hr>
<h2 id="Recap-–-Imperative"><a href="#Recap-–-Imperative" class="headerlink" title="Recap – Imperative"></a>Recap – Imperative</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> getIncompleteTaskSummariesForMember_imperative = <span class="keyword">function</span>(<span class="params">memberName</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fetchData</span>()</span><br><span class="line">        .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> data.<span class="property">tasks</span>;</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">tasks</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> results = [];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tasks[i].<span class="property">member</span> == memberName) &#123;</span><br><span class="line">                    results.<span class="title function_">push</span>(tasks[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> results;</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">tasks</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> results = [];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!tasks[i].<span class="property">complete</span>) &#123;</span><br><span class="line">                    results.<span class="title function_">push</span>(tasks[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> results;</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">tasks</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> results = [], task;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = tasks.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">                task = tasks[i];</span><br><span class="line">                results.<span class="title function_">push</span>(&#123;</span><br><span class="line">                    <span class="attr">id</span>: task.<span class="property">id</span>,</span><br><span class="line">                    <span class="attr">dueDate</span>: task.<span class="property">dueDate</span>,</span><br><span class="line">                    <span class="attr">title</span>: task.<span class="property">title</span>,</span><br><span class="line">                    <span class="attr">priority</span>: task.<span class="property">priority</span></span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> results;</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">tasks</span>) &#123;</span><br><span class="line">            tasks.<span class="title function_">sort</span>(<span class="keyword">function</span>(<span class="params">first, second</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> first.<span class="property">dueDate</span> - second.<span class="property">dueDate</span>;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">return</span> tasks;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Recap-–-Functional"><a href="#Recap-–-Functional" class="headerlink" title="Recap – Functional"></a>Recap – Functional</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> getIncompleteTaskSummariesForMemberFunctional = <span class="keyword">function</span>(<span class="params">memberName</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fetchData</span>()</span><br><span class="line">        .<span class="title function_">then</span>(<span class="title function_">get</span>(<span class="string">&#x27;tasks&#x27;</span>))</span><br><span class="line">        .<span class="title function_">then</span>(<span class="title function_">filter</span>(<span class="title function_">propEq</span>(<span class="string">&#x27;member&#x27;</span>, memberName)))</span><br><span class="line">        .<span class="title function_">then</span>(<span class="title function_">reject</span>(<span class="title function_">propEq</span>(<span class="string">&#x27;complete&#x27;</span>, <span class="literal">true</span>)))</span><br><span class="line">        .<span class="title function_">then</span>(<span class="title function_">map</span>(<span class="title function_">pick</span>([<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;dueDate&#x27;</span>, <span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;priority&#x27;</span>])))</span><br><span class="line">        .<span class="title function_">then</span>(<span class="title function_">sortBy</span>(<span class="title function_">get</span>(<span class="string">&#x27;dueDate&#x27;</span>)));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Most-Important-Functions"><a href="#Most-Important-Functions" class="headerlink" title="Most Important Functions"></a>Most Important Functions</h2><p>We’ve seen what are probably the most important functions in functional programming:</p>
<ul>
<li>map</li>
<li>reduce</li>
<li>filter</li>
<li>compose</li>
<li>curry</li>
</ul>
<p>There’s one that to some might be conspicuous by it’s absence:</p>
<ul>
<li>forEach<br>Maybe it is not actually appropriate to functional programming, as its main purpose is to help you achieve side-effects. But many libraries do include one.</li>
</ul>
<hr>
<h3 id="What-We-Gain-from-FP-Style"><a href="#What-We-Gain-from-FP-Style" class="headerlink" title="What We Gain from FP Style"></a>What We Gain from FP Style</h3><ul>
<li>Elegance and simplicity</li>
<li>Easier decomposition of problems</li>
<li>Code more closely tied to the problem domain</li>
</ul>
<p><strong>And through these, we can also achieve</strong></p>
<ul>
<li>Straightforward unit testing</li>
<li>Easier debugging</li>
<li>Simple concurrency</li>
</ul>
</div><div class="tags"><a href="/tags/JavaScript"><i class="fa fa-tag">JavaScript</i></a><a href="/tags/FP"><i class="fa fa-tag">FP</i></a><a href="/tags/Functional Programming"><i class="fa fa-tag">Functional Programming</i></a><a href="/tags/Ramda"><i class="fa fa-tag">Ramda</i></a></div><div class="post-nav"><a class="pre" href="/2015/05/08/2-minute-introduction-to-Rx/">两分钟了解ReactiveX</a><a class="next" href="/2015/03/16/%E4%BF%AE%E5%A4%8DAWS%E4%B8%8AEC2%E6%8D%9F%E5%9D%8F%E7%9A%84sshd-config%E6%96%87%E4%BB%B6/">修复AWS上EC2损坏的sshd_config文件</a></div><link rel="stylesheet" type="text/css" href="https://unpkg.com/disqusjs@1.3/dist/disqusjs.css"><script type="text/javascript" src="https://unpkg.com/disqusjs@1.3/dist/disqus.js"></script><script type="text/javascript" id="disqus-count-script">$(function() {
  var xhr = new XMLHttpRequest();
  xhr.open('GET', '//disqus.com/next/config.json', true);
  xhr.timeout = 2500;
  xhr.onreadystatechange = function () {
    if (xhr.readyState === 4 && xhr.status === 200) {
      $('.post-meta .post-comments-count').show();
      var s = document.createElement('script');
      s.id = 'dsq-count-scr';
      s.src = 'https://owenyang.disqus.com/count.js';
      s.async = true;
      (document.head || document.body).appendChild(s);
    }
  };
  xhr.ontimeout = function () { xhr.abort(); };
  xhr.send(null);
});</script><div class="comments" id="disqus_thread"><script type="text/javascript">// Load comments with DisqusJS
function loadComments() {
  window.dsqjs = new DisqusJS({
    shortname: 'owenyang',
    siteName: '修远',
    identifier: '2015/04/12/functional-programming-in-javascript/',
    url: 'https://owenyang0.github.io/2015/04/12/functional-programming-in-javascript/',
    title: 'Functional Programming in JavaScript',
    api: '',
    apikey: '',
    admin: '',
    adminLabel: ''
  });
}
// Lazy load {# Credit: https://github.com/theme-next/hexo-theme-next/blob/master/layout/_third-party/comments/disqus.swig #}
(function () {
  var offsetTop = document.getElementById('disqus_thread').offsetTop - window.innerHeight;
  if (offsetTop <= 0) {
    // Load directly when there's no scrollbar
    window.addEventListener('load', loadComments, false);
  } else {
    var disqusScroll = function () {
      // offsetTop may changes because of manually resizing browser window or lazy loading images
      var offsetTop = document.getElementById('disqus_thread').offsetTop - window.innerHeight;
      var scrollTop = window.scrollY;

      // Pre-load comments a bit? (margin or anything else)
      if (offsetTop - scrollTop < 60) {
        window.removeEventListener('scroll', disqusScroll);
        loadComments();
      }
    };
    window.addEventListener('scroll', disqusScroll);
  }
})();
// Scroll to comments automatically if #comment-xxx anchor specified
window.addEventListener('load', function () {
  // I don't know why, it just works.
  window.setTimeout(function () {
    if (location.hash.indexOf('#comment-') !== -1) {
      document.getElementById('disqus_thread').scrollIntoView(true);
    }
  }, 100);
}, false);
</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://owenyang0.github.io"/></form></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="关于"><img class="nofancybox" src="/img/avatar.jpg"/></a><p>技术宅，电子垃圾体验者、生产者、回收者，挨踢FEer</p><a class="info-icon" href="mailto:songallica@gmail.com" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/owenyang0" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/">前端进阶系列教程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E6%B2%89%E6%B7%80/">技术沉淀</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/">软件工具</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Rx/" style="font-size: 15px;">Rx</a> <a href="/tags/RxJS/" style="font-size: 15px;">RxJS</a> <a href="/tags/Reactive-Programming/" style="font-size: 15px;">Reactive Programming</a> <a href="/tags/2014/" style="font-size: 15px;">2014</a> <a href="/tags/2015/" style="font-size: 15px;">2015</a> <a href="/tags/goal/" style="font-size: 15px;">goal</a> <a href="/tags/summary/" style="font-size: 15px;">summary</a> <a href="/tags/plan/" style="font-size: 15px;">plan</a> <a href="/tags/AEM/" style="font-size: 15px;">AEM</a> <a href="/tags/CMS/" style="font-size: 15px;">CMS</a> <a href="/tags/Drupal/" style="font-size: 15px;">Drupal</a> <a href="/tags/Adobe/" style="font-size: 15px;">Adobe</a> <a href="/tags/Experience-Management/" style="font-size: 15px;">Experience Management</a> <a href="/tags/Babel/" style="font-size: 15px;">Babel</a> <a href="/tags/Rollup/" style="font-size: 15px;">Rollup</a> <a href="/tags/Modules/" style="font-size: 15px;">Modules</a> <a href="/tags/ES6/" style="font-size: 15px;">ES6</a> <a href="/tags/NPM/" style="font-size: 15px;">NPM</a> <a href="/tags/JavaScript/" style="font-size: 15px;">JavaScript</a> <a href="/tags/Tab/" style="font-size: 15px;">Tab</a> <a href="/tags/ECMAScript-6/" style="font-size: 15px;">ECMAScript 6</a> <a href="/tags/Array/" style="font-size: 15px;">Array</a> <a href="/tags/TDD/" style="font-size: 15px;">TDD</a> <a href="/tags/Mocha/" style="font-size: 15px;">Mocha</a> <a href="/tags/MaintainableCSS/" style="font-size: 15px;">MaintainableCSS</a> <a href="/tags/CSS/" style="font-size: 15px;">CSS</a> <a href="/tags/Semantics/" style="font-size: 15px;">Semantics</a> <a href="/tags/npm/" style="font-size: 15px;">npm</a> <a href="/tags/npm-install/" style="font-size: 15px;">npm install</a> <a href="/tags/killed/" style="font-size: 15px;">killed</a> <a href="/tags/memory/" style="font-size: 15px;">memory</a> <a href="/tags/npm-install-killed/" style="font-size: 15px;">npm install killed</a> <a href="/tags/Template/" style="font-size: 15px;">Template</a> <a href="/tags/Template-String/" style="font-size: 15px;">Template String</a> <a href="/tags/React/" style="font-size: 15px;">React</a> <a href="/tags/ReactJS/" style="font-size: 15px;">ReactJS</a> <a href="/tags/JS/" style="font-size: 15px;">JS</a> <a href="/tags/Facebook/" style="font-size: 15px;">Facebook</a> <a href="/tags/ubuntu/" style="font-size: 15px;">ubuntu</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/git-server/" style="font-size: 15px;">git server</a> <a href="/tags/gitolite/" style="font-size: 15px;">gitolite</a> <a href="/tags/css/" style="font-size: 15px;">css</a> <a href="/tags/table-cell/" style="font-size: 15px;">table-cell</a> <a href="/tags/display/" style="font-size: 15px;">display</a> <a href="/tags/position/" style="font-size: 15px;">position</a> <a href="/tags/relative/" style="font-size: 15px;">relative</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/aws/" style="font-size: 15px;">aws</a> <a href="/tags/ec2/" style="font-size: 15px;">ec2</a> <a href="/tags/ssh/" style="font-size: 15px;">ssh</a> <a href="/tags/passwd/" style="font-size: 15px;">passwd</a> <a href="/tags/amazon-web-services/" style="font-size: 15px;">amazon-web-services</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/" style="font-size: 15px;">前端进阶</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95/" style="font-size: 15px;">前端面试</a> <a href="/tags/HTML5/" style="font-size: 15px;">HTML5</a> <a href="/tags/intern/" style="font-size: 15px;">intern</a> <a href="/tags/newegg/" style="font-size: 15px;">newegg</a> <a href="/tags/graduate/" style="font-size: 15px;">graduate</a> <a href="/tags/%E8%B7%9F%E6%89%93%E5%99%A8/" style="font-size: 15px;">跟打器</a> <a href="/tags/%E8%99%8E%E7%A0%81%E7%BB%83%E4%B9%A0/" style="font-size: 15px;">虎码练习</a> <a href="/tags/closure/" style="font-size: 15px;">closure</a> <a href="/tags/2016/" style="font-size: 15px;">2016</a> <a href="/tags/FP/" style="font-size: 15px;">FP</a> <a href="/tags/Functional-Programming/" style="font-size: 15px;">Functional Programming</a> <a href="/tags/Ramda/" style="font-size: 15px;">Ramda</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2023/03/26/%E5%9F%BA%E7%A1%80-01-HTML5%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7%E4%B8%8E%E6%A1%88%E4%BE%8B%E6%BC%94%E7%A4%BA/">基础 | 01 HTML5的新特性与案例演示</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/26/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%85%A8%E6%96%B9%E4%BD%8D%E6%B7%B1%E5%BA%A6%E8%BF%9B%E9%98%B6%E6%8C%87%E5%8D%97/">前端技术全方位深度进阶指南</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/01/29/%E6%9C%A8%E6%98%93%E8%B7%9F%E6%89%93%E5%99%A8-2-%E6%89%93%E5%AD%97%E7%BB%83%E4%B9%A0mac%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%B8%8E%E7%BD%91%E9%A1%B5%E7%89%88/">木易跟打器[2]-打字练习mac客户端与网页版</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/01/07/%E6%9C%A8%E6%98%93%E8%B7%9F%E6%89%93%E5%99%A8-macOS%E4%B8%8A%E5%8F%AF%E7%9B%B4%E6%8E%A5%E8%BD%BD%E6%96%87%E7%9A%84%E8%B7%9F%E6%89%93%E5%99%A8/">木易跟打器[1]-macOS上可直接载文的跟打器</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/19/MaintainableCSS-Semantics/">编写可维护性CSS之二，语义化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/19/MaintainableCSS-introduction/">编写可维护性CSS之一，前言</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/14/Build-and-Public-ES6-Modules-Today/">Babel和Rollup，开始构建发布你的ES6模块(Modules)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/03/%E8%B5%B6%E5%9C%A82015%E6%9C%80%E5%90%8E%E4%B8%80%E7%8F%AD%E8%BD%A6/">赶在2015最后一班车</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/31/Overview-of-ES6/">Overview of ES6</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/08/2-minute-introduction-to-Rx/">两分钟了解ReactiveX</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最近评论</i></div><script type="text/javascript" src="//owenyang.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://typer.owenyang.top/#/about" title="木易跟打器macOS版" target="_blank">木易跟打器macOS版</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">修远.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="复制成功！"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>