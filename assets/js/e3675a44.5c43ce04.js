"use strict";(self.webpackChunkowenyang_website=self.webpackChunkowenyang_website||[]).push([[9056],{4788:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>o});var r=s(7624),c=s(2172);const i={title:"\u7c7b\u578b | 04 TypeScript\u4e2d\u7684\u9006\u53d8\u4e0e\u534f\u53d8",date:new Date("2024-01-30T12:51:07.000Z"),authors:"owen",tags:["TypeScript","\u524d\u7aef\u9762\u8bd5","JavaScript"]},d=void 0,l={permalink:"/blog/2024/01/30/contravariant-and-covariant-in-typescript",source:"@site/blog/2024-01-30-contravariant-and-covariant-in-typescript.md",title:"\u7c7b\u578b | 04 TypeScript\u4e2d\u7684\u9006\u53d8\u4e0e\u534f\u53d8",description:"\u5728 TypeScript \u4e2d\uff0c\u7c7b\u578b\u7cfb\u7edf\u7684\u4e00\u90e8\u5206\u662f\u5173\u4e8e\u5982\u4f55\u5904\u7406\u51fd\u6570\u53c2\u6570\u548c\u8fd4\u56de\u503c\u7684\u7c7b\u578b\u7684\u3002\u8fd9\u5c31\u6d89\u53ca\u5230\u4e86 \u9006\u53d8\uff08contravariant\uff09 \u548c  \u534f\u53d8\uff08covariant\uff09 \u7684\u6982\u5ff5\u3002\u5728TypeScript\u4e2d\u5b66\u4e60\u534f\u53d8\u6027\u548c\u9006\u53d8\u6027\u53ef\u80fd\u6709\u4e9b\u68d8\u624b\uff0c\u4f46\u662f\u4e86\u89e3\u5b83\u4eec\u5bf9\u4e8e\u7406\u89e3\u7c7b\u578b\u548c\u5b50\u7c7b\u578b\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u8865\u5145\u3002",date:"2024-01-30T12:51:07.000Z",formattedDate:"2024\u5e741\u670830\u65e5",tags:[{label:"TypeScript",permalink:"/blog/tags/type-script"},{label:"\u524d\u7aef\u9762\u8bd5",permalink:"/blog/tags/\u524d\u7aef\u9762\u8bd5"},{label:"JavaScript",permalink:"/blog/tags/java-script"}],readingTime:8.185,hasTruncateMarker:!0,authors:[{name:"\u6728\u6613(OwenYang)",title:"\u4e92\u8054\u7f51\u4eba\u3001\u7535\u5b50\u5783\u573e\u4f53\u9a8c\u8005\u3001\u6328\u8e22FEer\u3001\u6728\u6613\u8ddf\u6253\u5668\u4f5c\u8005",url:"https://github.com/owenyang0",imageURL:"https://static.owenyang.top/blogs/avatar.jpg",key:"owen"}],frontMatter:{title:"\u7c7b\u578b | 04 TypeScript\u4e2d\u7684\u9006\u53d8\u4e0e\u534f\u53d8",date:"2024-01-30T12:51:07.000Z",authors:"owen",tags:["TypeScript","\u524d\u7aef\u9762\u8bd5","JavaScript"]},unlisted:!1,prevItem:{title:"\u5de5\u5177 | \u9ad8\u6027\u80fdZed\u7f16\u8f91\u5668\u5f00\u6e90\uff0c\u54cd\u5e94\u901f\u5ea6\u8d85\u5feb\u3001\u5e72\u6389VS Code\uff1f",permalink:"/blog/2024/01/31/high-performace-editor-zed-in-rust"},nextItem:{title:"\u6280\u5de7 | 03 JavaScript \u4e2d\u5c06 ArrayBuffer \u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32",permalink:"/blog/2023/04/01/\u6280\u5de7-03-JavaScript-\u4e2d\u5c06-ArrayBuffer-\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32"}},t={authorsImageUrls:[void 0]},o=[{value:"01 \u5b50\u7c7b\u578b\u5316",id:"01-\u5b50\u7c7b\u578b\u5316",level:2},{value:"\ud83d\ude06 \u5de5\u5177\u51fd\u6570",id:"-\u5de5\u5177\u51fd\u6570",level:3},{value:"02 \u534f\u53d8\uff08Covariant\uff09",id:"02-\u534f\u53d8covariant",level:2},{value:"\ud83d\ude01 \u534f\u53d8\uff08Covariant\uff09\u7684\u5b9a\u4e49\uff1a",id:"-\u534f\u53d8covariant\u7684\u5b9a\u4e49",level:3},{value:"03 \u9006\u53d8\uff08Contravariant\uff09",id:"03-\u9006\u53d8contravariant",level:2},{value:"\ud83d\ude0e \u9006\u53d8\uff08Contravariant\uff09\u7684\u5b9a\u4e49\uff1a",id:"-\u9006\u53d8contravariant\u7684\u5b9a\u4e49",level:3},{value:"04 \u51fd\u6570\u5b50\u7c7b\u578b\u5316",id:"04-\u51fd\u6570\u5b50\u7c7b\u578b\u5316",level:2},{value:"05 \u7ed3\u8bba",id:"05-\u7ed3\u8bba",level:2}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.M)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["\u5728 ",(0,r.jsx)(n.code,{children:"TypeScript"})," \u4e2d\uff0c\u7c7b\u578b\u7cfb\u7edf\u7684\u4e00\u90e8\u5206\u662f\u5173\u4e8e\u5982\u4f55\u5904\u7406\u51fd\u6570\u53c2\u6570\u548c\u8fd4\u56de\u503c\u7684\u7c7b\u578b\u7684\u3002\u8fd9\u5c31\u6d89\u53ca\u5230\u4e86 ",(0,r.jsx)(n.strong,{children:"\u9006\u53d8\uff08contravariant\uff09"})," \u548c  ",(0,r.jsx)(n.strong,{children:"\u534f\u53d8\uff08covariant\uff09"})," \u7684\u6982\u5ff5\u3002\u5728TypeScript\u4e2d\u5b66\u4e60\u534f\u53d8\u6027\u548c\u9006\u53d8\u6027\u53ef\u80fd\u6709\u4e9b\u68d8\u624b\uff0c\u4f46\u662f\u4e86\u89e3\u5b83\u4eec\u5bf9\u4e8e\u7406\u89e3\u7c7b\u578b\u548c\u5b50\u7c7b\u578b\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u8865\u5145\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"01-\u5b50\u7c7b\u578b\u5316",children:"01 \u5b50\u7c7b\u578b\u5316"}),"\n",(0,r.jsxs)(n.p,{children:["\u5b50\u7c7b\u578b\u5316\u662f\u591a\u6001\u6027\u7684\u4e00\u79cd\u5f62\u5f0f\uff0c\u5176\u4e2d ",(0,r.jsx)(n.strong,{children:"\u5b50\u7c7b\u578b"})," \u901a\u8fc7\u67d0\u79cd\u5f62\u5f0f\u7684\u53ef\u66ff\u6362\u6027\u4e0e ",(0,r.jsx)(n.strong,{children:"\u57fa\u672c\u7c7b\u578b"})," \u76f8\u5173\u8054\u3002\n\u53ef\u66ff\u6362\u6027\u610f\u5473\u7740\u57fa\u672c\u7c7b\u578b\u7684\u53d8\u91cf\u4e5f\u53ef\u4ee5\u63a5\u53d7\u5b50\u7c7b\u578b\u503c\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u4f8b\u5982\uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u57fa\u7c7b ",(0,r.jsx)(n.code,{children:"User"})," \u548c\u4e00\u4e2a ",(0,r.jsx)(n.code,{children:"Admin"}),"(\u6269\u5c55 ",(0,r.jsx)(n.code,{children:"User"})," \u7c7b)\u7684\u7c7b\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-TypeScript",children:"class User {\n  username: string;\n\n  constructor(username: string) {\n    this.username = username;\n  }\n}\n\nclass Admin extends User {\n  isSuperAdmin: boolean;\n\n  constructor(username: string, isSuperAdmin: boolean) {\n    super(username);\n    this.isSuperAdmin = isSuperAdmin;\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u7531\u4e8e",(0,r.jsx)(n.code,{children:"Admin"}),"\u6269\u5c55\u81ea ",(0,r.jsx)(n.code,{children:"User"}),"(",(0,r.jsx)(n.code,{children:"Admin extends User"}),")\uff0c\u6211\u4eec\u53ef\u4ee5\u8bf4",(0,r.jsx)(n.code,{children:"Admin"}),"\u662f\u57fa\u672c\u7c7b\u578b",(0,r.jsx)(n.code,{children:"User"}),"\u7684\u5b50\u7c7b\u578b\u3002\n",(0,r.jsx)(n.img,{src:"https://pic1.zhimg.com/80/v2-969851c28c9f0b9b7bb57f1fd4f9ab70_1440w.webp",alt:""})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Admin"}),"\uff08\u5b50\u7c7b\u578b\uff09\u548c",(0,r.jsx)(n.code,{children:"User"}),"\uff08\u57fa\u672c\u7c7b\u578b\uff09\u7684\u53ef\u66ff\u6362\u6027\u5728\u4e8e\u53ef\u4ee5\u5c06",(0,r.jsx)(n.code,{children:"Admin"}),"\u7c7b\u578b\u7684\u5b9e\u4f8b\u5206\u914d\u7ed9",(0,r.jsx)(n.code,{children:"User"}),"\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u4f8b\u5982\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-TypeScript",children:"const user1: User = new User('user1');         // OK\nconst user2: User = new Admin('admin1', true); // also OK\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u5982\u4f55\u4ece\u53ef\u66ff\u4ee3\u6027\u4e2d\u53d7\u76ca\uff1f"})}),"\n",(0,r.jsx)(n.p,{children:"\u6700\u5927\u7684\u597d\u5904\u4e4b\u4e00\u662f\u53ef\u4ee5\u5b9a\u4e49\u4e0d\u4f9d\u8d56\u4e8e\u7ec6\u8282\u7684\u884c\u4e3a\u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u60a8\u53ef\u4ee5\u521b\u5efa\u63a5\u53d7\u57fa\u7c7b\u578b\u4f5c\u4e3a\u53c2\u6570\u7684\u51fd\u6570\uff0c\u7136\u540e\u53ef\u4ee5\u4f7f\u7528\u5b50\u7c7b\u578b\u8c03\u7528\u8be5\u51fd\u6570\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u4f8b\u5982\uff0c\u7f16\u5199\u4e00\u4e2a\u5c06\u7528\u6237\u540d\u8bb0\u5f55\u5230\u63a7\u5236\u53f0\u7684\u51fd\u6570\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-TypeScript",children:"function logUsername(user: User): void {\n  console.log(user.username);\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u8be5\u51fd\u6570\u63a5\u53d7\u7684\u53c2\u6570\u7c7b\u578b\u53ef\u4ee5\u4e3a",(0,r.jsx)(n.code,{children:"User"}),",",(0,r.jsx)(n.code,{children:"Admin"}),"\u548c\u4efb\u4f55\u5176\u4ed6\u57fa\u4e8e",(0,r.jsx)(n.code,{children:"User"}),"\u5b50\u7c7b\u578b\u3002\u8fd9\u4f7f\u5f97",(0,r.jsx)(n.code,{children:"logUsername()"}),"\u66f4\u5177\u53ef\u91cd\u7528\u6027\uff0c\u5e76\u4e14\u4e0d\u7528\u5173\u6ce8\u7ec6\u8282\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-TypeScript",children:"logUsername(new User('user1'));         // logs \"user1\"\nlogUsername(new Admin('admin1', true)); // logs \"admin1\"\n"})}),"\n",(0,r.jsx)(n.h3,{id:"-\u5de5\u5177\u51fd\u6570",children:"\ud83d\ude06 \u5de5\u5177\u51fd\u6570"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u73b0\u5728\u8ba9\u6211\u4eec\u4ecb\u7ecd\u4e00\u4e0b\u8fd9\u4e2a\u7b26\u53f7 ",(0,r.jsx)(n.code,{children:"A <: B"})," \u2014\u2014 \u610f\u601d\u662f ",(0,r.jsx)(n.strong,{children:"\u201cA\u662fB\u7684\u5b50\u7c7b\u578b\u201d"}),"\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u56e0\u4e3a ",(0,r.jsx)(n.code,{children:"Admin"})," \u662f ",(0,r.jsx)(n.code,{children:"User"})," \u7684\u5b50\u7c7b\u578b\uff0c\u73b0\u5728\u4f60\u53ef\u4ee5\u7b80\u5199\u6210\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-TypeScript",children:"Admin <: User\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u8f85\u52a9\u7c7b\u578b ",(0,r.jsx)(n.code,{children:"IsSubtypeOf<S, P>"}),"\uff0c\u5982\u679c ",(0,r.jsx)(n.code,{children:"S"})," \u662f ",(0,r.jsx)(n.code,{children:"P"})," \u7684\u5b50\u7c7b\u578b\uff0c\u5219\u8bc4\u4f30\u4e3a ",(0,r.jsx)(n.code,{children:"true"}),"\uff0c\u5426\u5219\u4e3a ",(0,r.jsx)(n.code,{children:"false"}),"\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-TypeScript",children:"type IsSubtypeOf<S, P> = S extends P ? true : false;\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"IsSubtypeOf<Admin, User>"})," \u8ba1\u7b97\u7ed3\u679c\u4e3atrue \u56e0\u4e3a",(0,r.jsx)(n.code,{children:"Admin"}),"\u662f",(0,r.jsx)(n.code,{children:"User"}),"\u7684\u5b50\u7c7b\u578b\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-TypeScript",children:"type T11 = IsSubtypeOf<Admin, User>; // true\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5f88\u591a\u7c7b\u578b\u90fd\u53ef\u4ee5\u8fdb\u884c\u5b50\u7c7b\u578b\u5316\uff0c\u5305\u62ec\u57fa\u7840\u7c7b\u578b\u548c\u5185\u7f6e JavaScript \u7c7b\u578b\u3002"}),"\n",(0,r.jsxs)(n.p,{children:["\u4f8b\u5982\u5b57\u9762\u91cf\u5b57\u7b26\u4e32",(0,r.jsx)(n.code,{children:"'Hello'"}),"\u7684\u7c7b\u578b\u662f ",(0,r.jsx)(n.code,{children:"string"})," \u7684\u5b50\u7c7b\u578b\uff0c\u5b57\u9762\u91cf\u6570\u5b57 ",(0,r.jsx)(n.code,{children:"42"})," \u7684\u7c7b\u578b\u662f ",(0,r.jsx)(n.code,{children:"number"})," \u7684\u5b50\u7c7b\u578b\uff0c",(0,r.jsx)(n.code,{children:"Map<K, V>"}),"\u662f",(0,r.jsx)(n.code,{children:"Object"}),"\u7684\u5b50\u7c7b\u578b\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"type T12 = IsSubtypeOf<'hello', string>; // true\ntype T13 = IsSubtypeOf<42, number>; // true\ntype T14 = IsSubtypeOf<Map<string, string>, Object>; // true\n"})}),"\n",(0,r.jsx)(n.h2,{id:"02-\u534f\u53d8covariant",children:"02 \u534f\u53d8\uff08Covariant\uff09"}),"\n",(0,r.jsxs)(n.p,{children:["\u5047\u8bbe\u6211\u4eec\u6709\u4e00\u6bb5\u5f02\u6b65\u4ee3\u7801\u7528\u4e8e\u83b7\u53d6 ",(0,r.jsx)(n.code,{children:"User"})," \u548c ",(0,r.jsx)(n.code,{children:"Admin"})," \u5b9e\u4f8b\uff0c\u9700\u8981\u5904\u7406 ",(0,r.jsx)(n.code,{children:"Promise<User>"})," \u548c ",(0,r.jsx)(n.code,{children:"Promise<Admin>"}),"\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u4e00\u4e2a\u6709\u8da3\u7684\u95ee\u9898\u662f\uff1a\u5982\u679c ",(0,r.jsx)(n.code,{children:"Admin <: User"}),"\uff0c\u90a3\u4e48 ",(0,r.jsx)(n.code,{children:"Promise<Admin> <: Promise<User>"})," \u662f\u5426\u4e5f\u6210\u7acb\uff1f\u8fd9\u91cc\u505a\u4e2a\u5b9e\u9a8c\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"type T21 = IsSubtypeOf<Promise<Admin>, Promise<User>> // true\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5f53 ",(0,r.jsx)(n.code,{children:"Admin <: User"})," \u65f6\uff0c",(0,r.jsx)(n.code,{children:"Promise<Admin> <: Promise<User>"})," \u4e5f\u6210\u7acb\u3002\u8fd9\u8bf4\u660ePromise\u662f ",(0,r.jsx)(n.strong,{children:"\u534f\u53d8(Covariant)\u7c7b\u578b"}),"\u3002"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://pic4.zhimg.com/80/v2-c27f11dabc873c1a47f3855fc6cfa367_1440w.webp",alt:""})}),"\n",(0,r.jsx)(n.h3,{id:"-\u534f\u53d8covariant\u7684\u5b9a\u4e49",children:"\ud83d\ude01 \u534f\u53d8\uff08Covariant\uff09\u7684\u5b9a\u4e49\uff1a"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u5982\u679c ",(0,r.jsx)(n.code,{children:"S <: P"})," \u4e14 ",(0,r.jsx)(n.code,{children:"T<S> <: T<P>"})," \u90a3\u5c31\u53ef\u4ee5\u8bf4 ",(0,r.jsx)(n.code,{children:"T"})," \u662f ",(0,r.jsx)(n.strong,{children:"\u534f\u53d8\u7c7b\u578b"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5982\u679cAdmin\u662fUser\u7684\u5b50\u7c7b\u578b\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u9884\u671f ",(0,r.jsx)(n.code,{children:"Promise<Admin>"})," \u662f ",(0,r.jsx)(n.code,{children:"Promise<User>"})," \u7684\u5b50\u7c7b\u578b\u3002"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u534f\u53d8\u5728TypeScript\u4e2d\u9002\u7528\u4e8e\u8bb8\u591a\u7c7b\u578b"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["A) ",(0,r.jsx)(n.code,{children:"Promise<V>"}),"\uff08\u5982\u4e0a\u6240\u793a\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:["B) ",(0,r.jsx)(n.code,{children:"Record<K,V>"}),":"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"type RecordOfAdmin = Record<string, Admin>;\ntype RecordOfUser  = Record<string, User>;\n\ntype T22 = IsSubtypeOf<RecordOfAdmin, RecordOfUser>; // true\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["C) ",(0,r.jsx)(n.code,{children:"Map<K,V>"}),":"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"type MapOfAdmin = Map<string, Admin>;\ntype MapOfUser  = Map<string, User>;\n\ntype T23 = IsSubtypeOf<MapOfAdmin, MapOfUser>; // true\n"})}),"\n",(0,r.jsx)(n.h2,{id:"03-\u9006\u53d8contravariant",children:"03 \u9006\u53d8\uff08Contravariant\uff09"}),"\n",(0,r.jsx)(n.p,{children:"\u5206\u6790\u4ee5\u4e0b\u6cdb\u578b\u7c7b\u578b\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"type Func<Param> = (param: Param) => void;\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Func<Param>"}),"\u521b\u5efa\u4e86\u4e00\u4e2a\u51fd\u6570\u7c7b\u578b\uff0c\u8be5\u7c7b\u578b\u5e26\u4e00\u4e2a\u7c7b\u578b\u4e3a",(0,r.jsx)(n.code,{children:"Param"}),"\u7684\u53c2\u6570\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5f53",(0,r.jsx)(n.code,{children:"Admin <: User"}),"\u65f6\uff0c\u4ee5\u4e0b\u54ea\u4e2a\u8868\u8fbe\u5f0f\u4e3a\u771f\uff1a"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Func<Admin> <: Func<User>"})," \u6216\u8005"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Func<User> <: Func<Admin>"})," \uff1f"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u73b0\u5728\u8bd5\u4e00\u4e0b\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"type T31 = IsSubtypeOf<Func<Admin>, Func<User>> // false\ntype T32 = IsSubtypeOf<Func<User>, Func<Admin>> // true\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Func<User> <: Func<Admin>"}),"\u6210\u7acb - \u8fd9\u610f\u5473\u7740",(0,r.jsx)(n.code,{children:"Func<User>"}),"\u662f",(0,r.jsx)(n.code,{children:"Func<Admin>"}),"\u7684\u5b50\u7c7b\u578b\u3002\u4e0e\u539f\u59cb\u7c7b\u578b\u5173\u7cfb ",(0,r.jsx)(n.code,{children:"Admin <: User"}),"\u76f8\u6bd4\uff0c\u5b50\u7c7b\u578b\u7684\u65b9\u5411\u5df2\u7ecf\u53d1\u751f ",(0,r.jsx)(n.strong,{children:"\u7ffb\u8f6c"}),"\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Func"})," \u7c7b\u578b\u7684\u8fd9\u79cd\u884c\u4e3a\u4f7f\u5176\u5177\u6709 ",(0,r.jsx)(n.strong,{children:"\u9006\u53d8\u6027(Contravariant)"})," \u3002\u4e00\u822c\u6765\u8bf4\uff0c",(0,r.jsx)(n.em,{children:(0,r.jsx)(n.strong,{children:"\u51fd\u6570\u7c7b\u578b\u76f8\u5bf9\u5176\u53c2\u6570\u7c7b\u578b\u662f\u9006\u53d8\u7684\u3002"})})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://pic3.zhimg.com/80/v2-b78dd8ff5799fc732ce53c02a95d783e_1440w.webp",alt:""})}),"\n",(0,r.jsx)(n.h3,{id:"-\u9006\u53d8contravariant\u7684\u5b9a\u4e49",children:"\ud83d\ude0e \u9006\u53d8\uff08Contravariant\uff09\u7684\u5b9a\u4e49\uff1a"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u5982\u679c ",(0,r.jsx)(n.code,{children:"S <: P"})," \u4e14 ",(0,r.jsx)(n.code,{children:"T<P> <: T<S>"})," \u90a3\u5c31\u53ef\u4ee5\u8bf4 ",(0,r.jsx)(n.code,{children:"T"})," \u662f",(0,r.jsx)(n.strong,{children:"\u9006\u53d8\u7c7b\u578b"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u51fd\u6570\u7c7b\u578b\u7684\u5b50\u7c7b\u578b\u5316\u65b9\u5411\u4e0e\u53c2\u6570\u7c7b\u578b\u7684\u5b50\u7c7b\u578b\u5316\u65b9\u5411\u76f8\u53cd\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"type FuncUser = (p: User) => void;\ntype FuncAdmin = (p: Admin) => void;\n\ntype T31 = IsSubtypeOf<Admin, User>; // true\n\ntype T32 = IsSubtypeOf<FuncUser, FuncAdmin>; // true\n"})}),"\n",(0,r.jsx)(n.h2,{id:"04-\u51fd\u6570\u5b50\u7c7b\u578b\u5316",children:"04 \u51fd\u6570\u5b50\u7c7b\u578b\u5316"}),"\n",(0,r.jsx)(n.p,{children:"\u51fd\u6570\u5b50\u7c7b\u578b\u5316\u7ed3\u5408\u4e86\u534f\u53d8\u548c\u9006\u53d8\u3002"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u5982\u679c\u4e00\u4e2a\u51fd\u6570\u7684\u53c2\u6570\u7c7b\u578b\u76f8\u5bf9\u4e8e\u5176\u57fa\u672c\u7c7b\u578b\u662f",(0,r.jsx)(n.strong,{children:"\u9006\u53d8\u7684(Contravariant)"}),"\uff0c\u5e76\u4e14\u8fd4\u56de\u7c7b\u578b\u76f8\u5bf9\u4e8e\u5176\u57fa\u672c\u7c7b\u578b\u7684\u8fd4\u56de\u7c7b\u578b\u662f",(0,r.jsx)(n.strong,{children:"\u534f\u53d8\u7684(Covariant)"}),"\uff0c\u90a3\u4e48\u8be5\u51fd\u6570\u7c7b\u578b\u662f\u5176\u57fa\u672c\u7c7b\u578b\u7684\u5b50\u7c7b\u578b\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.em,{children:["\u6ce8\uff1a\u5f53\u542f\u7528 ",(0,r.jsx)(n.a,{href:"https://www.typescriptlang.org/tsconfig#strictFunctionTypes",children:"strictFunctionTypes"})," \u6a21\u5f0f\u65f6\u3002"]})}),"\n",(0,r.jsxs)(n.p,{children:["\u6362\u53e5\u8bdd\u8bf4\uff0c\u51fd\u6570\u7684\u5b50\u7c7b\u578b\u5316\u8981\u6c42\u53c2\u6570\u7c7b\u578b\u662f\u9006\u53d8\u7684\uff0c\u800c\u8fd4\u56de\u7c7b\u578b\u662f\u534f\u53d8\u7684\u3002\n",(0,r.jsx)(n.img,{src:"https://pic1.zhimg.com/80/v2-78b80adb1c87dd22f981614b8b871138_1440w.webp",alt:""})]}),"\n",(0,r.jsx)(n.p,{children:"\u4f8b\u5982\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"type SubtypeFunc = (p: User) => '1' | '2';\ntype BaseFunc = (p: Admin) => string;\n\ntype T41 = IsSubtypeOf<SubtypeFunc, BaseFunc> // true\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"SubtypeFunc <: BaseFunc"})," \u56e0\u4e3a\uff1a"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["A) \u53c2\u6570\u7c7b\u578b\u662f\u9006\u53d8\u7684\uff08\u5b50\u7c7b\u578b\u5316\u65b9\u5411\u7ffb\u8f6c ",(0,r.jsx)(n.code,{children:"User :> Admin"}),"\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:["B) \u8fd4\u56de\u7c7b\u578b\u662f\u534f\u53d8\u7684\uff08\u76f8\u540c\u7684\u5b50\u7c7b\u578b\u65b9\u5411 ",(0,r.jsx)(n.code,{children:"'1' | '2' <: string"}),"\uff09\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u4e86\u89e3\u5b50\u7c7b\u578b\u5316\u975e\u5e38\u6709\u52a9\u4e8e\u7406\u89e3\u51fd\u6570\u7c7b\u578b\u7684\u53ef\u66ff\u6362\u6027\u3002"}),"\n",(0,r.jsxs)(n.p,{children:["\u4f8b\u5982\uff0c\u6709\u4e00\u4e2a",(0,r.jsx)(n.code,{children:"Admin"}),"\u5b9e\u4f8b\u5217\u8868\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const admins: Admin[] = [\n  new Admin('john.smith', false),\n  new Admin('jane.doe', true),\n  new Admin('joker', false)\n];\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u63a5\u53d7\u4ec0\u4e48\u7c7b\u578b\u7684\u56de\u8c03 ",(0,r.jsx)(n.code,{children:"admins.filter(...)"})," \u5462\uff1f\u663e\u7136\uff0c\u5b83\u63a5\u53d7\u5e26\u6709\u4e00\u4e2a ",(0,r.jsx)(n.code,{children:"Admin"})," \u7c7b\u578b\u53c2\u6570\u7684\u56de\u8c03\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const admins: Admin[] = [\n  new Admin('john.smith', false),\n  new Admin('jane.doe', true),\n  new Admin('joker', false)\n];\n\nconst superAdmins = admins.filter((admin: Admin): boolean => {\n  return admin.isSuperAdmin;\n});\n\nconsole.log(superAdmins); // [ Admin('jane.doe', true) ]\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u4f46 ",(0,r.jsx)(n.code,{children:"admins.filter(...)"})," \u662f\u5426\u80fd\u63a5\u53d7 ",(0,r.jsx)(n.code,{children:"User"})," \u7c7b\u578b\u53c2\u6570\u7684\u56de\u8c03\u5462\uff1f"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const jokers = admins.filter((user: User): boolean => {\n  return user.username.startsWith('joker');\n});\n\nconsole.log(jokers); // [ Admin('joker', false) ]\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u6ca1\u9519 ",(0,r.jsx)(n.code,{children:"admins.filter()"})," \u63a5\u53d7 ",(0,r.jsx)(n.code,{children:"(admin: Admin) => boolean"})," \u57fa\u672c\u7c7b\u578b\uff0c\u540c\u65f6\u4e5f\u63a5\u53d7\u5176\u5b50\u7c7b\u578b\uff0c\u4f8b\u5982 ",(0,r.jsx)(n.code,{children:"(user: User) => boolean"}),"\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5982\u679c\u9ad8\u9636\u51fd\u6570\u63a5\u53d7\u7279\u5b9a\u7c7b\u578b\u7684\u56de\u8c03\uff0c\u4f8b\u5982 ",(0,r.jsx)(n.code,{children:"(admin: Admin) => boolean"}),"\uff0c\u90a3\u4e48\u8fd8\u53ef\u4ee5\u63d0\u4f9b\u4f5c\u4e3a\u7279\u5b9a\u7c7b\u578b\u7684\u5b50\u7c7b\u578b\u7684\u56de\u8c03\uff0c\u4f8b\u5982 ",(0,r.jsx)(n.code,{children:"(user: User) => boolean"}),"\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"05-\u7ed3\u8bba",children:"05 \u7ed3\u8bba"}),"\n",(0,r.jsxs)(n.p,{children:["\u5047\u8bbe\u6709\u4e24\u4e2a\u7c7b\u578b ",(0,r.jsx)(n.code,{children:"S"})," \u4e0e ",(0,r.jsx)(n.code,{children:"P"})," \u4e24\u8005\u5173\u7cfb ",(0,r.jsx)(n.code,{children:"S <: P"}),"\uff1a"]}),"\n",(0,r.jsxs)(n.p,{children:["1\u3001\u5982\u679c ",(0,r.jsx)(n.code,{children:"T<S> <: T<P>"})," (\u5b50\u7c7b\u578b\u65b9\u5411\u88ab\u4fdd\u6301)\uff0c\u5219\u7c7b\u578b ",(0,r.jsx)(n.code,{children:"T"})," \u662f**\u534f\u53d8\u7684\u3002 ",(0,r.jsx)(n.em,{children:(0,r.jsxs)(n.strong,{children:["\u5982 ",(0,r.jsx)(n.code,{children:"Promise<T>"})," \u5373\u662f\u4e00\u4e2a\u534f\u53d8\u7c7b\u578b\u3002"]})})]}),"\n",(0,r.jsxs)(n.p,{children:["2\u3001\u5982\u679c ",(0,r.jsx)(n.code,{children:"T<P> <: T<S>"})," (\u5b50\u7c7b\u578b\u5173\u7cfb\u88ab\u7ffb\u8f6c)\uff0c\u5219\u7c7b\u578b ",(0,r.jsx)(n.code,{children:"T"})," \u662f",(0,r.jsx)(n.strong,{children:"\u9006\u53d8\u7684\u3002"})]}),"\n",(0,r.jsx)(n.p,{children:"\u51fd\u6570\u5b50\u7c7b\u578b\u5316\u5728\u53c2\u6570\u7c7b\u578b\u4e0a\u662f\u9006\u53d8\u7684\uff0c\u4f46\u5728\u8fd4\u56de\u7c7b\u578b\u4e0a\u662f\u534f\u53d8\u7684\u3002"})]})}function h(e={}){const{wrapper:n}={...(0,c.M)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},2172:(e,n,s)=>{s.d(n,{I:()=>l,M:()=>d});var r=s(1504);const c={},i=r.createContext(c);function d(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:d(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);